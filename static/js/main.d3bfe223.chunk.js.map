{"version":3,"sources":["ActionStack/ActionStack.js","components/ActionButton.js","components/Input.js","ActionStackSamples/UndoableForm.js","ActionStackSamples/HookSample.js","ActionStackSamples/HOCSample.js","ActionStackSamples/ProviderSampleConsumer.js","ActionStackSamples/ProviderSample.js","App.js","index.js"],"names":["useActionStack","initialState","useState","Logic","createInitialHistory","history","setHistory","state","getCurrentState","onAction","newState","onUndo","steps","onRedo","numberOfAvailableUndos","getNumberOfAvailableUndos","numberOfAvailableRedos","getNumberOfAvailableRedos","ActionStackContext","createContext","ActionStackProvider","children","props","Provider","value","array","historyIndex","Math","max","length","previousState","diffForUndo","Object","keys","earlierUndoDiffs","slice","newKeys","previousKeys","_","difference","Error","historyDraft","i","currentState","diffForRedo","laterRedoDiffs","nextState","object","referenceObject","differences","key","hasOwnProperty","call","ActionButton","onClick","numberOfAvailableOperations","isMouseIn","setIsMouseIn","additionalButtonCount","additionalButtonArray","Array","fill","map","x","type","className","onMouseLeave","onMouseEnter","disabled","CSSTransition","in","classNames","mountOnEnter","unmountOnExit","timeout","Input","typeProps","valueSelector","formId","name","referenceValue","onChange","checked","event","target","parsedValue","parseInt","isNaN","TypeError","htmlFor","id","UndoableForm","draftState","setDraftState","useEffect","draft","isEqual","HookSample","WrappedComponent","HOCSample","this","React","Component","withActionStack","actionStackHookProps","ProviderSampleConsumer","actionStackProps","useContext","ProviderSample","Consumer","dev","qa","prod","text","number","App","sample","setSample","transitionProps","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d3bfe223.chunk.js","sourcesContent":["import _ from 'lodash/array';\r\nimport { useState, createContext, useContext } from 'react';\r\n\r\n// --- Hook --------------------------------------------------------------------\r\nexport function useActionStack(initialState) {\r\n  const [history, setHistory] = useState(\r\n    Logic.createInitialHistory(initialState)\r\n  );\r\n\r\n  return {\r\n    state: Logic.getCurrentState(history),\r\n    onAction: (newState) => setHistory(Logic.onAction(newState)),\r\n    onUndo: (steps) => setHistory(Logic.onUndo(steps)),\r\n    onRedo: (steps) => setHistory(Logic.onRedo(steps)),\r\n    numberOfAvailableUndos: Logic.getNumberOfAvailableUndos(history),\r\n    numberOfAvailableRedos: Logic.getNumberOfAvailableRedos(history),\r\n  };\r\n}\r\n\r\n// --- HOC ---------------------------------------------------------------------\r\nexport const withActionStack = (WrappedComponent) => ({\r\n  initialState,\r\n  ...props\r\n}) => {\r\n  const actionStackHookProps = useActionStack(initialState);\r\n\r\n  return <WrappedComponent {...props} {...actionStackHookProps} />;\r\n};\r\n\r\n// --- Provider ----------------------------------------------------------------\r\nexport const ActionStackContext = createContext(null);\r\n\r\nexport function useActionStackContext() {\r\n  return useContext(ActionStackContext);\r\n}\r\n\r\nexport function ActionStackProvider({ initialState, children }) {\r\n  const props = useActionStack(initialState);\r\n\r\n  return (\r\n    <ActionStackContext.Provider value={props}>\r\n      {children}\r\n    </ActionStackContext.Provider>\r\n  );\r\n}\r\n\r\n// --- Business logic, exported for tests --------------------------------------\r\nexport class Logic {\r\n  static createInitialHistory = (initialState) => ({\r\n    array: [initialState],\r\n    historyIndex: 0,\r\n  });\r\n\r\n  static getCurrentState = (history) => history.array[history.historyIndex];\r\n\r\n  static getNumberOfAvailableUndos = (history) => history.historyIndex;\r\n\r\n  static getNumberOfAvailableRedos = (history) =>\r\n    Math.max(history.array.length - 1 - history.historyIndex, 0);\r\n\r\n  static onAction = (newState) => (history) => {\r\n    const previousState = Logic.getCurrentState(history);\r\n    Logic.#assertKeysInNewState(newState, previousState);\r\n\r\n    const diffForUndo = Logic.#getDifferences(previousState, newState);\r\n    const hasStateChanged = Object.keys(diffForUndo).length > 0;\r\n\r\n    if (hasStateChanged) {\r\n      const earlierUndoDiffs = history.array.slice(0, history.historyIndex);\r\n      return {\r\n        array: [...earlierUndoDiffs, diffForUndo, newState],\r\n        historyIndex: history.historyIndex + 1,\r\n      };\r\n    } else {\r\n      return history;\r\n    }\r\n  };\r\n\r\n  static #assertKeysInNewState = (newState, previousState) => {\r\n    const newKeys = Object.keys(newState);\r\n    const previousKeys = Object.keys(previousState);\r\n\r\n    if (\r\n      _.difference(newKeys, previousKeys).length ||\r\n      _.difference(previousKeys, newKeys).length\r\n    ) {\r\n      throw new Error(\r\n        'ActionStack.onAction received a new state ' +\r\n          'that has different keys than the previous one.'\r\n      );\r\n    }\r\n  };\r\n\r\n  static onUndo = (steps = 1) => (history) => {\r\n    if (steps <= history.historyIndex) {\r\n      let historyDraft = { ...history };\r\n\r\n      for (let i = 0; i < steps; i++) {\r\n        historyDraft = Logic.#undoOneStep(historyDraft);\r\n      }\r\n\r\n      return historyDraft;\r\n    } else {\r\n      return history;\r\n    }\r\n  };\r\n\r\n  static #undoOneStep = (history) => {\r\n    const currentState = Logic.getCurrentState(history);\r\n    const previousState = {\r\n      ...currentState,\r\n      ...history.array[history.historyIndex - 1],\r\n    };\r\n\r\n    const diffForRedo = Logic.#getDifferences(currentState, previousState);\r\n    const earlierUndoDiffs = history.array.slice(0, history.historyIndex - 1);\r\n    const laterRedoDiffs = history.array.slice(history.historyIndex + 1);\r\n\r\n    return {\r\n      array: [\r\n        ...earlierUndoDiffs,\r\n        previousState,\r\n        diffForRedo,\r\n        ...laterRedoDiffs,\r\n      ],\r\n      historyIndex: history.historyIndex - 1,\r\n    };\r\n  };\r\n\r\n  static onRedo = (steps = 1) => (history) => {\r\n    if (steps <= history.array.length - 1 - history.historyIndex) {\r\n      let historyDraft = { ...history };\r\n\r\n      for (let i = 0; i < steps; i++) {\r\n        historyDraft = Logic.#redoOneStep(historyDraft);\r\n      }\r\n\r\n      return historyDraft;\r\n    } else {\r\n      return history;\r\n    }\r\n  };\r\n\r\n  static #redoOneStep = (history) => {\r\n    const currentState = Logic.getCurrentState(history);\r\n    const nextState = {\r\n      ...currentState,\r\n      ...history.array[history.historyIndex + 1],\r\n    };\r\n\r\n    const diffForUndo = Logic.#getDifferences(currentState, nextState);\r\n    const earlierUndoDiffs = history.array.slice(0, history.historyIndex);\r\n    const laterRedoDiffs = history.array.slice(history.historyIndex + 2);\r\n\r\n    return {\r\n      array: [...earlierUndoDiffs, diffForUndo, nextState, ...laterRedoDiffs],\r\n      historyIndex: history.historyIndex + 1,\r\n    };\r\n  };\r\n\r\n  static #getDifferences = (object, referenceObject) => {\r\n    const differences = {};\r\n\r\n    for (const key in referenceObject) {\r\n      if (Object.hasOwnProperty.call(referenceObject, key)) {\r\n        if (referenceObject[key] !== object[key]) {\r\n          differences[key] = object[key];\r\n        }\r\n      }\r\n    }\r\n    return differences;\r\n  };\r\n}\r\n","import React, { useState } from 'react';\r\nimport { CSSTransition } from 'react-transition-group';\r\n\r\nimport './ActionButton.css';\r\n\r\nfunction ActionButton({ onClick, numberOfAvailableOperations, children }) {\r\n  const [isMouseIn, setIsMouseIn] = useState(false);\r\n\r\n  const additionalButtonCount = Math.max(0, numberOfAvailableOperations - 1);\r\n  const additionalButtonArray = new Array(additionalButtonCount)\r\n    .fill(0)\r\n    .map((x, i) => (\r\n      <button\r\n        type=\"button\"\r\n        key={i + 2}\r\n        onClick={() => {\r\n          setIsMouseIn(false);\r\n          onClick(i + 2);\r\n        }}\r\n      >\r\n        {i + 2} steps\r\n      </button>\r\n    ));\r\n\r\n  return (\r\n    <div className=\"action-button\" onMouseLeave={() => setIsMouseIn(false)}>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => onClick()}\r\n        onMouseEnter={() => setIsMouseIn(true)}\r\n        disabled={numberOfAvailableOperations === 0}\r\n      >\r\n        {children}\r\n      </button>\r\n\r\n      <CSSTransition\r\n        in={numberOfAvailableOperations > 1 && isMouseIn}\r\n        classNames=\"fade-in\"\r\n        mountOnEnter\r\n        unmountOnExit\r\n        timeout={300}\r\n      >\r\n        <div\r\n          className=\"additional-buttons\"\r\n          onMouseEnter={() => setIsMouseIn(true)}\r\n        >\r\n          {additionalButtonArray}\r\n        </div>\r\n      </CSSTransition>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ActionButton;\r\n","import React from 'react';\r\n\r\nimport './Input.css';\r\n\r\nfunction Input({ formId, name, value, referenceValue, onChange }) {\r\n  let typeProps, valueSelector;\r\n\r\n  switch (typeof value) {\r\n    case 'boolean':\r\n      typeProps = { type: 'checkbox', checked: value };\r\n      valueSelector = (event) => event.target.checked;\r\n      break;\r\n    case 'string':\r\n      typeProps = { type: 'text', value: value };\r\n      valueSelector = (event) => event.target.value;\r\n      break;\r\n    case 'number':\r\n      typeProps = { type: 'number', value: value };\r\n      valueSelector = (event) => {\r\n        const parsedValue = parseInt(event.target.value);\r\n        if (isNaN(parsedValue)) {\r\n          return 0;\r\n        } else {\r\n          return parsedValue;\r\n        }\r\n      };\r\n      break;\r\n    default:\r\n      throw new TypeError(`Input component: unsupported type: ${typeof value}`);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={\r\n        'input-field ' + (value !== referenceValue ? 'diff-highlight' : '')\r\n      }\r\n    >\r\n      <label htmlFor={formId + name}>{name}:</label>\r\n\r\n      <input\r\n        {...typeProps}\r\n        id={formId + name}\r\n        onChange={(event) => onChange(valueSelector(event))}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Input;\r\n","import _ from 'lodash';\r\nimport { useState, useEffect } from 'react';\r\n\r\nimport ActionButton from '../components/ActionButton';\r\nimport Input from '../components/Input';\r\nimport './UndoableForm.css';\r\n\r\nfunction UndoableForm({\r\n  state,\r\n  onAction,\r\n  onUndo,\r\n  onRedo,\r\n  numberOfAvailableUndos,\r\n  numberOfAvailableRedos,\r\n  formId = '',\r\n}) {\r\n  const [draftState, setDraftState] = useState(null);\r\n\r\n  useEffect(() => {\r\n    setDraftState(state);\r\n  }, [state]);\r\n\r\n  return (\r\n    <form className=\"undoable-form\">\r\n      {draftState &&\r\n        Object.keys(draftState).map((key) => (\r\n          <Input\r\n            formId={formId}\r\n            key={key}\r\n            name={key}\r\n            value={draftState[key]}\r\n            onChange={(value) =>\r\n              setDraftState((draft) => ({ ...draft, [key]: value }))\r\n            }\r\n            referenceValue={state[key]}\r\n          />\r\n        ))}\r\n\r\n      <div className=\"button-container\">\r\n        <ActionButton\r\n          numberOfAvailableOperations={numberOfAvailableUndos}\r\n          onClick={onUndo}\r\n        >\r\n          Undo\r\n        </ActionButton>\r\n\r\n        <ActionButton\r\n          numberOfAvailableOperations={numberOfAvailableRedos}\r\n          onClick={onRedo}\r\n        >\r\n          Redo\r\n        </ActionButton>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => onAction(draftState)}\r\n          disabled={_.isEqual(draftState, state)}\r\n        >\r\n          Save\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default UndoableForm;\r\n","import { useActionStack } from '../ActionStack/ActionStack';\r\nimport UndoableForm from './UndoableForm';\r\n\r\nfunction HookSample({ initialState, className }) {\r\n  const props = useActionStack(initialState);\r\n\r\n  return (\r\n    <div className={className}>\r\n      <h2>useActionStack hook example</h2>\r\n\r\n      <UndoableForm formId=\"hook\" {...props} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HookSample;\r\n","import React from 'react';\r\n\r\nimport { withActionStack } from '../ActionStack/ActionStack';\r\nimport UndoableForm from './UndoableForm';\r\n\r\nclass HOCSample extends React.Component {\r\n  render() {\r\n    return (\r\n      <div className={this.props.className}>\r\n        <h2>ActionStack HOC example</h2>\r\n\r\n        <UndoableForm formId=\"hoc\" {...this.props} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withActionStack(HOCSample);\r\n","import { useActionStackContext } from '../ActionStack/ActionStack';\r\nimport UndoableForm from './UndoableForm';\r\n\r\nfunction ProviderSampleConsumer(props) {\r\n  const actionStackProps = useActionStackContext();\r\n\r\n  return <UndoableForm {...props} {...actionStackProps} />;\r\n}\r\n\r\nexport default ProviderSampleConsumer;\r\n","import {\r\n  ActionStackProvider,\r\n  ActionStackContext,\r\n} from '../ActionStack/ActionStack';\r\nimport ProviderSampleConsumer from './ProviderSampleConsumer';\r\nimport UndoableForm from './UndoableForm';\r\n\r\nfunction ProviderSample({ initialState, className }) {\r\n  return (\r\n    <div className={className}>\r\n      <h2>ActionStack Provider example</h2>\r\n\r\n      <ActionStackProvider initialState={initialState}>\r\n        <ActionStackContext.Consumer>\r\n          {(props) => <UndoableForm {...props} formId=\"provider-1\" />}\r\n        </ActionStackContext.Consumer>\r\n\r\n        <h3>Same context:</h3>\r\n        <ProviderSampleConsumer formId=\"provider-2\" />\r\n      </ActionStackProvider>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProviderSample;\r\n","import React, { useState } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nimport './App.css';\nimport HookSample from './ActionStackSamples/HookSample';\nimport HOCSample from './ActionStackSamples/HOCSample';\nimport ProviderSample from './ActionStackSamples/ProviderSample';\n\nconst initialState = {\n  dev: true,\n  qa: true,\n  prod: false,\n  text: 'This is a text.',\n  number: 13,\n};\n\nfunction App() {\n  const [sample, setSample] = useState('hook');\n\n  const transitionProps = {\n    timeout: 550,\n    classNames: 'fade-in',\n    mountOnEnter: true,\n  };\n\n  return (\n    <div className=\"App\">\n      <h1>ActionStack</h1>\n\n      <form className=\"example-selector\">\n        <button type=\"button\" onClick={() => setSample('hook')}>\n          Hook\n        </button>\n        <button type=\"button\" onClick={() => setSample('hoc')}>\n          HOC\n        </button>\n        <button type=\"button\" onClick={() => setSample('provider')}>\n          Provider\n        </button>\n      </form>\n\n      <div className=\"sample-container\">\n        <CSSTransition in={sample === 'hook'} {...transitionProps}>\n          <HookSample className=\"sample\" initialState={initialState} />\n        </CSSTransition>\n\n        <CSSTransition in={sample === 'hoc'} {...transitionProps}>\n          <HOCSample className=\"sample\" initialState={initialState} />\n        </CSSTransition>\n\n        <CSSTransition in={sample === 'provider'} {...transitionProps}>\n          <ProviderSample className=\"sample\" initialState={initialState} />\n        </CSSTransition>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}